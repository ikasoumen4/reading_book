
# ストアドプロシージャとは

データベースに対する処理を一つのプログラムにまとめ、データベース管理システムに保存（STORE)したものです。
複雑なSQL文の呼び出しを論理的に一つの処理単位にまとめて、簡単にその名前で呼び出せるようになっています。
普通のプログラミング言語のように、繰り返しや条件分岐、引数を取って実行したりすることができます。


# メリット

データベースに１つずつSQL文を発行する必要がなくなる
ネットワーク上のトラフィックを削減できる
事前にデータベースに登録しておくため、コンパイルの処理時間を軽減することができる
DB上で処理が完結できるため、開発言語に依存しない

# デメリット



# 各ミドエルウェアのストアドプロシージャの実装
各データベースソフトによって実装が変わる。めんどくさい！


MySQL  ???
PostgreSQL PL/pgSQL
SQLServer Transcat-SQL
Oracle PL/SQL
Firebird PSQL



# 基本的な構文（Transcat-SQL）


//プロシージャの作成
CREATE PROCEDURE プロシージャ名
 [@パラメータ データ型, ……]
AS
 SQLステートメント

//プロシージャの変更
ALTER PROCEDURE


文法基礎
DECLARE @[変数名][型]
SELECT `[変数名]=[値]
--コメント
/*
複数コメント
*/

条件分岐
IF [条件式]
 BEGIN
  -- true
 END
ELSE
 BEGIN
  -- false
 END

WHILE[繰り返し条件]
 BEGIN
  -- repeat
 END


カーソル操作

DECLARE[カーソル名] CURSOR FOR [select 文]
OPEN[カーソル名]
FETCH NEXT FROM [カーソル名] INTO @[変数名]
CLOSE [カーソル名]
DEALLOCATE[カーソル名]








